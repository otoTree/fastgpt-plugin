# DocDiff 文档对比工具

一个用于对比两个 Markdown 文档差异的 FastGPT 工具，生成可视化的 HTML 对比报告。

## 功能特性

- 📝 **行级对比**: 逐行分析文档差异，精确识别变更
- 🎨 **可视化报告**: 生成美观的双栏 HTML 对比报告
- 🔄 **导航功能**: 支持按钮和键盘快捷键在变更间跳转
- 📊 **统计信息**: 显示新增、删除、修改、未修改的行数
- 🔒 **安全防护**: 自动转义 HTML 字符，防止 XSS 攻击
- 📱 **响应式设计**: 支持移动端浏览
- ⚡ **高性能**: 基于相似度算法的智能对比

## 使用方法

### 输入参数

- **originalText** (必需): 原始的 Markdown 文档内容
- **modifiedText** (必需): 修改后的 Markdown 文档内容
- **title** (可选): 对比报告的标题，默认为"文档对比报告"

### 输出

返回 HTML 文件访问 URL，包含：
- 文档标题和生成时间
- 变更统计信息
- 双栏对比视图（左为原始文档，右为修改后文档）
- 导航控制按钮
- 响应式设计支持

## 对比算法

工具使用智能的相似度算法来识别文档变化：

1. **行级分割**: 将文档按换行符分割为行
2. **相似度计算**: 基于字符级别的相似度匹配
3. **变更分类**:
   - 未修改 (>80% 相似度)
   - 修改 (10%-80% 相似度)
   - 新增 (仅在修改后文档中存在)
   - 删除 (仅在原始文档中存在)
4. **最佳匹配**: 寻找最相似的行配对

## 使用示例

```typescript
const result = await tool({
  originalText: `# 项目文档

## 功能介绍
这是一个测试功能。

## 安装步骤
1. 下载代码
2. 运行安装命令`,

  modifiedText: `# 项目文档

## 功能介绍
这是一个更新的测试功能。

## 安装步骤
1. 下载代码
2. 运行安装命令
3. 配置环境变量`,

  title: "项目文档变更记录"
});

console.log(result.htmlUrl); // 输出 HTML 对比报告 URL
```

## HTML 报告特性

- 🎨 **现代化设计**: 渐变背景、卡片布局、阴影效果
- 📈 **统计仪表板**: 直观显示各类变更数量
- 🔄 **双栏对比**: 左右并排显示原始和修改内容
- 🎯 **导航功能**: 点击按钮或使用键盘快捷键在变更间跳转
- 🏷️ **状态标签**: 不同颜色标识变更类型
- ✨ **高亮效果**: 柔和的高亮提示，自动消失
- 📝 **代码显示**: 使用等宽字体保持格式
- 📱 **响应式布局**: 自适应不同屏幕尺寸

## 技术实现

- **TypeScript**: 类型安全的实现
- **Zod 验证**: 输入参数验证
- **纯函数设计**: 无副作用的处理逻辑
- **HTML 安全**: 自动转义特殊字符

## 适用场景

- 📄 **文档版本对比**: 比较文档的不同版本
- 📝 **内容审核**: 查看内容修改记录
- 🔄 **变更追踪**: 跟踪文档变化
- 📊 **差异分析**: 分析文档变更模式

## 开发和测试

```bash
# 安装依赖
bun install

# 运行测试
bun test

# 类型检查
bun run tsc --noEmit

# 构建
bun run build
```

## 测试覆盖

- ✅ 输入验证测试
- ✅ 文档对比逻辑测试
- ✅ HTML 输出质量测试
- ✅ 边界情况测试
- ✅ 安全性测试

## 版本信息

- **当前版本**: 1.0.0
- **FastGPT 兼容性**: 完全兼容
- **依赖**: 仅依赖 Zod，无外部 API 调用
